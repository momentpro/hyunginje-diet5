# 구글 시트 연동 설정 가이드

## 🚀 바로 구글 시트에 저장하는 방법

### 1단계: Google Apps Script 프로젝트 생성

1. **https://script.google.com** 접속
2. **"새 프로젝트"** 클릭
3. 프로젝트 이름을 **"형인재 설문지 연동"**으로 변경

### 2단계: 코드 붙여넣기

1. `Code.gs` 파일에 기존 코드 삭제
2. `apps-script.js` 파일의 모든 내용을 복사해서 붙여넣기
3. **Ctrl+S (또는 Cmd+S)**로 저장

### 3단계: 웹앱 배포

1. **"배포"** > **"새 배포"** 클릭
2. **유형 선택**: "웹앱" 선택
3. **설정**:
   - 실행 계정: **"나"** 선택
   - 액세스 권한: **"모든 사용자"** 선택
4. **"배포"** 버튼 클릭
5. **웹앱 URL 복사** (예: `https://script.google.com/macros/s/AKfycbx...../exec`)

### 4단계: 설문지에 URL 적용

1. `index.html` 파일 열기
2. **2182번째 줄** 찾기:
   ```javascript
   const scriptURL = 'https://script.google.com/macros/s/AKfycbxQYourDeploymentIdHere/exec';
   ```
3. 복사한 웹앱 URL로 교체:
   ```javascript
   const scriptURL = '복사한_실제_URL_여기에_붙여넣기';
   ```
4. 파일 저장

### 5단계: 권한 승인

1. Apps Script에서 **"실행"** > **"testFunction"** 선택
2. **"실행"** 버튼 클릭
3. 권한 요청 시 **"권한 검토"** 클릭
4. 계정 선택 후 **"고급"** > **"프로젝트로 이동"** 클릭
5. **"허용"** 클릭

## ✅ 테스트 방법

### 구글 시트 확인
- https://docs.google.com/spreadsheets/d/1HHpMjj3I_7eCm8Ce3tVjj-68JwUUfcO7X5hed5dsXLA/edit
- 설문 제출 후 "시트1" 탭에서 데이터 확인

### 디버깅
1. **Apps Script 로그**: https://script.google.com에서 실행 내역 확인
2. **브라우저 콘솔**: F12 > Console에서 오류 메시지 확인

## 🔧 문제 해결

### "권한이 없습니다" 오류
- Apps Script 배포 시 "액세스 권한"을 "모든 사용자"로 설정했는지 확인

### 데이터가 저장되지 않는 경우
1. 구글 시트 ID가 올바른지 확인
2. Apps Script 코드의 `SHEET_ID` 변수 확인
3. 웹앱 URL이 올바르게 적용되었는지 확인

### CORS 오류
- `mode: 'no-cors'` 설정이 적용되어 있어 대부분 해결됨
- 여전히 문제가 있다면 Apps Script에서 새 배포 버전 생성

## 📊 데이터 형태

구글 시트에는 다음과 같은 형태로 저장됩니다:

| 제출일시 | 이름 | 휴대폰 번호 | 이메일 | 성별 | 나이 | ... |
|---------|------|------------|-------|------|------|-----|
| 2024-01-15 10:30:25 | 홍길동 | 010-1234-5678 | hong@email.com | 남성 | 30 | ... |

## 🎯 완료!

이제 설문지 제출 시 **자동으로 구글 시트에 저장**됩니다!
- 실시간 데이터 수집 ✅
- 자동 백업 (로컬 스토리지 + 파일 다운로드) ✅
- 구글 시트에서 바로 관리 ✅
